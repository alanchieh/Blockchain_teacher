# A Blockchain-Based Interoperable Architecture forIoT with Selective Disclosure of Information

Last edited time: August 8, 2023 2:49 PM
Status: Not started
Created: August 4, 2023 2:51 PM

Decentralised IDentifier(DID)、DID DOcument (DDO)

abstract

隨著物聯網（IoT）技術、服務和應用的不斷改進，人們日常生活中智能設備的接入也越來越多。然而，在高度動態和大規模的物聯網部署中，為每個資源授予訪問權限並控制訪問權限是一個具有挑戰性的任務。特別是，在授予對多個資源的訪問權限時，可能需要向實體提供多個訪問信息。當實體需要分享其身份屬性以獲得訪問信息時，情況變得更加複雜。這引發了一個問題，即實體需要提供什麼身份信息來獲得對特定資源的所需訪問權限，隨後在訪問該資源時需要提供什麼訪問信息。因此，需要一種靈活的方法，其中實體可以在訪問資源時分享不同的身份和訪問屬性，而無需揭示其他信息。這種信息共享的靈活性對於保護實體身份的隱私風險非常重要。本文提出了一種架構，可實現對實體進行訪問權限的選擇性披露。我們的方法確保在授予實體訪問權限時最少地交換信息（身份和訪問屬性），以增強實體的隱私。我們使用區塊鏈提供數據的真實性（即防篡改）、透明性和基於智能合約的共享屬性的自動執行訪問權限。我們通過使用Hyperledger Fabric作為許可的區塊鏈網絡，實現了所提出系統的概念證明。我們的結果顯示了所提出系統的可行性，並展示了在授予訪問權限方面的高效性。

一、introduction

隨著物聯網科技和應用、智慧穿戴設備和可擕式感測器的快速發展，在日常生活中使用這些科技和應用的趨勢越來越大[1]。 據預測，到2025年，將有500億臺互聯網連接設備[2]。 這種增長伴隨著對安全的需求，以更好地為科技和人民服務。 除其他外，存取控制是必須解决的覈心安全問題之一，以確保用戶和資源的身份驗證和授權。

確認用戶身份對於為不同資源和組織提供正確的訪問權限至關重要。然而，每個資源使用獨立的識別符可能導致用戶需要維護許多登錄賬戶，同時在訪問組織內的多個資源時可能出現數據互操作性問題。當兩個使用獨立訪問控制機制的組織必須交換員工（例如，專業護理人員）以為用戶提供更好的服務時，情況也是類似的。例如，在圖1所示的物聯網智能醫療系統中，醫生的能力去請求訪問是實現及時病人護理的關鍵，尤其考慮到在病人治療過程中可能需要不同的專業護理人員之間的合作。

讓我們假設一種情況，即Dr. Hung，一名來自B醫院的麻醉師，受邀訪問A醫院的一名危重病人Alice。為了支持治療過程，A醫院需要向Dr. Hung提供必要的訪問權限（例如，A醫院的預留停車區、Alice的醫療數據和設備等信息），以便他在訪問期間能夠成功進行身份驗證。此外，A醫院和B醫院之間的數據互操作性是主要的挑戰，因為兩個組織可能具有適合的身份驗證流程的訪問控制機制。這兩個機制在需要時必須相互交互以進行身份驗證。例如，當Dr. Hung訪問A醫院時，需要對他進行身份驗證，以便控制訪問病人的數據和A醫院提供的相關服務。

![Untitled](A%20Blockchain-Based%20Interoperable%20Architecture%20forI%20a99a8e32ea024d2fa5aab1538c8c5b1a/Untitled.png)

A. Motivation and Problem Statement

在物聯網環境中，訪問資源可能需要頻繁的身份識別過程。此外，每個身份識別過程可能在授權之前需要不同的信息。例如，進入病人的房間可能需要不同於獲取病人記錄的訪問信息。現有的身份識別過程往往收集比絕對最小要求更多的信息（例如，掃描完整的身份證明）。將這些敏感信息定期公開給多個設備（包括跨不同系統和組織）會使實體面臨更高的隱私風險，可能會導致數據關聯或重新識別 [4]。這需要一種更靈活的身份驗證和授權方法，其中實體只希望共享僅用於獲取物聯網資源所需的身份信息。這支持有選擇性地披露身份的概念，使個人只共享訪問所需的信息 [5]。

我們假設醫生Hung已經由醫院B發放了一個"身份證明"，如圖1所示。這個證明可能包含了醫院B內許多身份識別信息和訪問權限，但僅有其中一部分信息是獲取醫院A的訪問權限所需的（例如，醫生註冊號碼、所屬機構和有效日期）。根據需求，Hung醫生可以使用這個帶有選擇性披露功能的身份證明在醫院A進行身份驗證。在這個選擇性披露的功能下，Hung醫生可以僅披露需要用於身份驗證的最小信息。通過身份證明獲得的這些訪問權限，醫院A可能會為Hung醫生發放另一個身份證明，並指定他在醫院A內的訪問權限。這個由醫院A發放的新身份證明允許Hung醫生訪問（例如）醫院A的員工停車區、Alice（即患者）的醫療記錄、患者房間以及位於患者房間的醫療設備。通過身份證明獲得這些訪問權限帶來了以下需要考慮的挑戰。首先，Hung醫生必須證明自己（選擇性披露的）身份是醫院B的一名醫生，以獲得來自醫院A的訪問權限。其次，Hung醫生必須能夠使用由醫院A發放的身份證明中的特定訪問權限來訪問適當的服務（例如醫療設備、數據、停車區）。

在傳統的存取控制框架（例如基於角色的存取控制（RBAC）、基於屬性的存取控制（ABAC）和基於能力的存取控制（CapBAC）[6]）中，一個存儲庫（例如屬性提供者）被認為存儲了與主體對應的所有身份屬性（例如員工ID、員工職位等），並提供與特定用戶身份相關的訪問屬性（例如訪問時間、位置、員工分配狀態等）用於授權[7]。最近，區塊鏈技術在存取控制環境中引起了相當大的關注。由於其架構的明確特性（例如可追溯性、可驗證性、可審計性、無需信任和完整性），區塊鏈提供了一個中立的第三方平台，可以建立信任，增加雙方（即訪問接收者和訪問提供者）的信心。因此，最近的一些提案使用區塊鏈平台來維護身份數據的完整性。例如，[8]建議將訪問權限作為每個身份屬性類的鍵值映射存儲在區塊鏈上。然而，這違反了幾個隱私規定和數據保護法（例如GDPR、HIPAA、CCPA）設定的用戶數據保護標準，因為身份屬性和訪問權限包含了用戶的“個人可識別信息”（PII）。為了解決用戶隱私問題，一些解決方案，例如[9]，建議使用離線機制將PII存儲在不同的位置，而區塊鏈只存儲對離線存儲的引用（例如PII的哈希值）。在本文中，我們打算使用區塊鏈遵循類似的機制，以確保區塊鏈存儲效率，並通過附加的隱私機制將用戶放在對其可互操作的PII的控制下。

B. Contributions

我們提出了一種基於區塊鏈的架構，用於在大規模物聯網系統中授予訪問權限，支持個人可選擇披露的個人可識別信息（PII）。也就是說，為了進行訪問，需要一組（或子集）身份，實體可以精確地提供所需的信息以獲取所需的訪問權限。然而，目前的文獻中缺乏在基於區塊鏈的平台上提供訪問權限時集成信息的選擇性披露和解決互操作性問題的相關研究。一方面，少數提案（例如[10]，[11]）討論了在使用區塊鏈的訪問控制系統中使用能力。但它們並未考慮在授予實體訪問權限時選擇性披露信息（例如身份）。
另一方面，少數提案（例如[12]，[13]）討論了使用區塊鏈選擇性披露信息（特別是身份和訪問權限）的需要。但是，它們既未提供有關物聯網的訪問控制問題的見解，也未討論在鏈上的存儲效率。據我們所知，我們的工作是第一個將訪問控制和身份管理集成使用信息選擇性披露的概念，並使用區塊鏈來提高互操作性和鏈上存儲效率的研究。

The major contributions of the paper can be summarised as follows:

- 我們提出了一種基於區塊鏈的物聯網互操作訪問控制架構，可在共享身份屬性以訪問資源時提供選擇性披露信息。
- 我們的提案架構保護高度的數據隱私，同時在授予實體訪問資源時也具有高效性。我們提出的身份和訪問權限選擇性披露方法提供了在鏈上的存儲效率。
- 我們使用能力來向實體轉移訪問權限。使用基於區塊鏈的可驗證身份和能力顯著提高了物聯網資源中數據訪問的靈活性。此外，將可驗證身份與不同組織發出的身份屬性集相關聯，促進了管理域和應用之間的互操作性。
- 我們提供了一個完整的概念證明實現，使用Hyperledger Fabric（即一個許可區塊鏈網絡）來展示系統在實際環境中的可行性。

論文的其餘部分組織如下。 在第二節中，我們介紹了與所提出的體系結構相對應的初步內容。 我們在第三節中總結了與身份管理集成的存取控制方案相關的突出研究成果。第四節討論了所提出的具有選擇性資訊披露的基於區塊鏈的存取控制架構。 我們討論了體系結構組件、系統功能、模型的正式定義和通信。 在第五節中，我們介紹了實現細節並討論了實驗結果。 最後，第六節對論文進行了總結，並提出了今後的工作。

二、Preliminaries

在本節中，我們將討論身份的定義以及與本文相關的三種身份管理方案。它們如下：

A. The Notion of Identity

實體（主體或客體）的身份可以描述為其是誰的事實。通常，一組識別符（也稱為屬性）可以代表一個實體的身份。這些識別符是該實體的特徵元素，用於特定的識別過程。在本文中，我們將身份稱為數字身份，它可以被表示為“將身份以適合計算機系統處理和解釋的方式進行數字編碼的形式”的形式[14]。身份管理模型（IDM）通過身份建立來驗證合法實體的身份，進而確定實體嘗試訪問資源的身份驗證和授權[15]。

最初的數字IDM是集中式的，其中一個實體需要為每個服務設置獨立的身份。為了減輕每個服務的獨立身份，出現了聯合IDM，通過使用單一身份可以訪問多個聯合服務。例如，“使用Google帳戶登錄”允許實體訪問多個服務。然而，這種IDM允許大型組織（如Google）收集大量的個人身份信息（PII）。這可能引發隱私問題，使這些大型組織成為受信任的仲裁者。因此，新的去中心化IDM稱為自主身份（SSI）已經出現，它不依賴於信任的第三方[16]。

B. Self-Sovereign Identity

SSI的功能使其與現有的支持數字身份的手段有所不同。SSI在身份發行者、用戶和驗證者之間建立了一個數字點對點網絡，其中區塊鏈充當信任的中介。在SSI中，用戶收到並存儲一組身份屬性在自己的個人存儲中。區塊鏈的加密構造確保身份屬性不可篡改並可驗證。因此，當與驗證者共享時，驗證者能夠從區塊鏈（即信任的中介）進行加密驗證身份屬性，而無需與發行者直接通信。這進一步使驗證過程更快速，並且獨立於單一中心實體。此外，SSI允許用戶的身份與不同組織發出的一組屬性相關聯。因此，它促進了管理領域和應用之間的互操作性。

C. Decentralised Identifiers and Verifiable Credentials

Verifiable Credential (VC) [17]和Decentralised Identifier (DID) [18]是由W3C（World Wide Web Consortium）標準化的用於實現SSI的技術。DID通過一個私鑰/公鑰對來表示用戶的身份，並且區塊鏈註冊了這些DID。每個DID與一個DID文檔（DDO）相關聯，其中包含了DID用戶的公鑰、兩個DID之間的通信協議以及用於交互的服務端點（例如HTTPS URL）。任何DID用戶都可以通過相應的私鑰證明其擁有權。

可驗證的憑證（VC）是憑證發行者關於憑證用戶的一個數字簽名斷言。一個憑證包含了其擁有者（即憑證用戶）的一組屬性。SSI使用公鑰加密來保證VC不可篡改。每個VC都包含了用戶的DID，以便用戶可以通過證明擁有自己的DID來證明他的憑證。

D. Interoperable Access Control using SSI

實現可審計、可驗證和可互操作的訪問控制機制對於任何系統的長期可持續性都至關重要。例如，在醫療保健系統中實現可互操作的訪問控制機制將為患者提供更好的治療，並獲得多個醫療專業人員的聯合治療計劃。在本文中，DID和VC規範在訪問控制過程中的目標是確保不同服務提供組織（例如醫院）之間的數據互操作性。

在訪問控制過程中，功能（也可以表示為令牌(token)）被定義為可通信、不可偽造的訪問權限令牌。一個功能包含了其所有者（即功能用戶）的一組訪問屬性。以VC形式的功能包含了來自功能發行者關於功能用戶的數字斷言。從我們的動機情景來看，醫院A（即功能發行者）使用與DID相關聯的私鑰為Dr Hung（即功能用戶）發行一個功能。驗證器（例如MRI機器）可以從區塊鏈帳本中讀取所需的DID（例如醫院A和Dr Hung的DID），以驗證Dr Hung共享的功能中醫院A的簽名。

E. Selective Disclosure

選擇性披露允許用戶分享他們身份憑證的子集。一個VC（或簡稱為憑證）可能包含多個敏感屬性，但往往只需要其中的一個子集（即必要屬性）來證明用戶的身份。例如，圖2中展示了一個選擇性披露的示例，用戶（例如Dr Hung）從身份發行者（例如醫院B）收到一組身份屬性（例如註冊ID，發行時間，到期時間等）。然後醫生可以選擇要與醫院A共享的必要屬性。在證明了這些披露的屬性後，醫院A將發行一個以VC形式的功能，並與Dr Hung的DID相關聯。為了要求訪問資源（例如停車區，病人記錄，房間和醫療設備），Dr Hung需要證明她擁有她的DID並證明她的特定訪問權限對於每個資源都是有效的，這需要來自於她的功能的功能發行者（即醫院A）的簽名。

選擇性披露簽名是實現選擇性披露的技術。在選擇性披露簽名中，發行者使用特定的簽名方案來簽署需要向驗證者披露的憑證屬性。驗證者能夠驗證完整的憑證，但只能看到披露的屬性。在這篇論文中，我們採用了可簽署簽名技術 [22]，它具有實現選擇性披露的能力。這與圖2中所示的示例類似，Dr Hung可以根據需求共享他選擇的身份屬性。其他支持選擇性披露的簽名方案要求發行者分別對每個屬性進行簽署，以便用戶可以使用相關聯的簽名披露所需的屬性作為證據 [23]，或者需要在工作流程中使用受信任的中介。可簽署簽名允許發行者只簽署一次完整的憑證，並且用戶可以從已簽署的憑證中生成多個用於多個屬性集合的索賠，而無需管理多個簽名或進行任何中介交互。

三、Related work

一些提案討論了使用區塊鏈的物聯網存取控制和身份管理問題。 然而，這些提案從設備的角度使用了物聯網的身份，並沒有將資訊（特別是身份和存取權限）的選擇性披露問題考慮到細粒度。 例如，Pal等人[24]討論了物聯網的基於區塊鏈的架構，用於在使用能力的用戶之間共亯存取權限。 在這種方法中，身份被定義為一組内容，這些内容可以為物聯網資源的身份驗證和授權提供必要的資訊。然而，與我們的動機不同，本文沒有討論用戶如何披露他們訪問特定資源的部分存取權限。 此外，互操作性問題沒有討論。

Mukta等人[25]提出了一種基於區塊鏈的架構，該架構考慮了身份的選擇性披露。 它使用基於區塊鏈的SSI平臺，為憑據的安全創建、共亯和驗證提供靈活性。
除了身份和憑證的驗證之外，還為使用可編輯簽名的通用憑證共亯場景開發了一種靈活的選擇性披露解決方案。 該體系結構允許用戶選擇共亯什麼資訊以及共亯多少資訊來訪問特定資源。 然而，該體系結構只顯示了使用SSI的身份管理，與我們的提案不同，它沒有討論存取控制策略的概念，囙此無法定義需要多少數據披露才能申請訪問。

廖等人[26]描述了一種基於區塊鏈的身份管理和存取控制框架，稱為“BIMAC”，用於開放銀行生態系統。 它使用基於區塊鏈的框架來解决與SSI的多個數位身份相關的身份集成挑戰，並通過識別和與特定實體組通信的方法來共亯隱私保護數據。 它使用了實體特定數據的可驗證表示的概念，該數據僅包含驗證所需的數據。 然而，與我們的建議不同，作者沒有討論存取控制中的互操作性。 此外，我們提供了對身份和存取權限共亯的選擇性披露的細粒度分析。

Belchior等人[27]提出了一種用於跨組織身份管理的存取控制架構，名為SSIBAC。在該體系結構中，一系列數學證明已用於内容的選擇性披露，以確保在“需要知道”的基礎上披露數據。 VC用於使用區塊鏈平臺進行身份管理。這種方法的概念是通過ABAC提供去中心化身份，其中需要使用VC將内容發佈到特定的DID。 然而，與我們不同的是，該提案將憑據和策略存儲在鏈上，囙此給鏈帶來了額外的負擔，這可能會引發區塊鏈的可擴展性問題。也就是說，我們只存儲該功能的散列和散列上的相關簽名，這提供了鏈上存儲效率。

其他建議，例如Naghmouchi等人[28]討論了將區塊鏈用於身份和訪問管理系統。
作者提出了一個模型，使用SSI為用戶和物聯網設備提供基於帳本的（使用區塊鏈智慧合約）身份。 Saidi等人[29]提出了一種使用基於區塊鏈的SSI進行數據存取控制的去中心化自我管理系統。 已經採用了一個智慧醫療保健用例來證明對個人數據的控制，並允許用戶自行授予對其醫療數據的存取權限。 馬等人[30]提出了一種使用“聯合區塊鏈”平臺的安全和去中心化SSI認證協定，該協定支持隱私保護和身份資訊的細粒度存取控制。 Hong和Kim[31]提出了一種符合OAuth2.0標準的基於區塊鏈的SSI。 他們使用區塊鏈從更受用戶控制的角度保護用戶的數據主權。 也就是說，用戶可以以去中心化的管道使用和管理他們的數據，而不是依賴於特定的壟斷服務提供者。 然而，與我們不同的是，上面提到的都沒有討論存取權限共亯期間的互操作性問題。

總之，現有提案要麼使用區塊鏈進行存取控制，要麼使用選擇性身份披露，而不考慮細粒度的存取控制。 相比之下，我們提出的存取控制機制利用基於區塊鏈的SSI生態系統選擇性披露資訊（身份和存取控制），旨在改善物聯網資源的隱私訪問管理。 接下來，我們將詳細討論我們提出的存取控制體系結構。

四、Proposed access control architecture

在本節中，我們將討論所提出的基於區塊鏈的存取控制架構。 首先，我們介紹了架構組件的基本定義。 其次，我們提出了我們所提出的體系結構模型的正式規範，然後提出了所提出的系統設計。 最後，根據我們的設計，詳細闡述了建築構件之間的通信。

A. Basic Definitions and Concepts

本節定義了基於區塊鏈的存取控制架構中存在的關鍵術語和用戶實體。 圖3顯示了具有必要組件的擬議架構。

- 資源：資源是嵌入感測器、軟件和其他科技的物理設備，如果符合訪問策略中的條件，則允許某些用戶（例如洪博士）訪問。
- 能力：能力是一組定義用戶存取權限的訪問内容，允許擁有訪問資源能力的用戶（我們將其稱為“能力用戶”）訪問資源。 關於能力的個人資訊，例如資源id（要訪問的資源/“內容”）、存取權限的日期和時間以及訪問位置，被稱為“能力内容”。
- 能力發佈者Capability Issuer：能力由能力發佈者（如醫院管理局）為能力用戶（如洪醫生）創建，並可由驗證器（如資源）進行加密驗證。
- 能力用戶Capability User：需要存取權限來操作資源的人（例如洪博士）。
- 能力範本Capability Template：在能力範本中捕獲能力内容（簡稱能力）。
功能用於生成索賠。
- 聲明Claim：聲明是用戶屬性的證明，通常包含能力中的一個子集。在我們的情境中，如果Dr. Hung選擇了一個能力中的訪問屬性子集來與特定資源共享，那麼這位醫生就是從他獲得的能力中創建了一個聲明。這樣的聲明可以被用來向特定資源證明他的身份和訪問權限。這使得Dr. Hung可以有彈性地共享必要的信息，同時保持他的隱私。
- 區塊鏈層Blockchain Layer：該層包括鏈上數據，即註冊表智慧合約（例如，用於管理DID的DID註冊表、用於管理憑據和功能的憑據註冊表）、功能範本和SD合約。 能力範本由能力發佈者基於預定義的一組規則生成。 SD合約是一種智慧合約，包括一個生成、驗證和管理身份憑證和功能的協定。 這是通過區塊鏈網絡進行通信的實體之間的自動執行契约。

B. A Formal Specification of Architectural Model

我們提出的架構模型由以下組件組成：

*A, Capt, Cap, U, R, O, Cla, Iss, I and V*

(attributes, capability templates, capabilities, users, resources, operations, classes, issuers, identities and verifiers)

我們將 Cla 表示為一個可擴展程序，它創建用於設計和構建應用程序的對象。

請注意，存在 CaptR 和 CaptO、CapR 和 CapO 等價物，將功能映射到資源和操作。功能通過 CapR 映射到的資源是 CaptR 中相應映射的子集，由參數化規則和提供的屬性定義。

用戶u、資源r和環境e的内容分配關係（ATTR）分別是ATTR（u）、ATTR（r）和ATTR（e）。

我們在模型中使用了以下三個基於内容的策略規則。

（1）身份披露規則：用戶和環境内容f（ATTR（u）,ATTR（e））的布林函數。 這適用於每個用戶的用戶到身份映射，並指定用戶（u）必須披露哪些内容才能在特定環境中獲得唯一身份（e）。 這表示如下：策略規則：Identity_Disclosure(u，e)← f(ATTR(u),ATTR(e))

(2)能力參數化規則：指定在給定用戶内容的情况下，使用能力範本（Capt）生成的能力可以訪問哪些資源的規則。 這表示如下：策略規則：Capability_P參數化(u,Capt)← f（ATTR(u)，Capt）

資源條件規則：這是資源和環境内容f（AT TR（t），AT TR（e））的布林函數。 它决定用戶（u）是否可以訪問特定環境（e）中的資源（r）。這表示如下：策略規則：資源1條件(r,e) ←  f(ATTR(u))、ATTR(e))

C. Access Control using Capability

本節介紹了使用選擇性公開的能力的所提出的存取控制機制的詳細設計。

![Untitled](A%20Blockchain-Based%20Interoperable%20Architecture%20forI%20a99a8e32ea024d2fa5aab1538c8c5b1a/Untitled%201.png)

![Untitled](A%20Blockchain-Based%20Interoperable%20Architecture%20forI%20a99a8e32ea024d2fa5aab1538c8c5b1a/Untitled%202.png)

1. 能力創建的系統功能：圖4顯示了使用能力模板進行能力創建過程的概要。值得注意的是，在我們的提案中，我們使用能力來授予訪問權限。W3C VC [17]數據模型規範定義了一種使用JSON-LD表達VC的標準方法。我們在圖5中展示的示例能力模板遵循了類似的標準方式來生成能力。
該能力模板由最高權威（例如，醫院管理層）生成並簽署，然後將其哈希和簽名存儲在區塊鏈上。在發放過程中，能力模板將被填充相關信息，例如有效時間和由能力發行者進行的適當參數化。每個能力使用者必須在發送能力請求之前將其DID註冊在區塊鏈上（步驟1）。能力使用者需要披露其身份屬性（步驟2），然後將請求能力發送給能力發行者（步驟3）。在從區塊鏈驗證身份屬性（步驟4）後，發行者檢查策略數據庫中的相應訪問策略（步驟5），並且如果滿足條件（步驟6），則使用適當的能力模板來實例化來自相應區塊鏈能力模板存儲的能力。

最後，發佈者創建能力（步驟7），並將簽名的能力發送給用戶（步驟8）。 使用有助於能力的選擇性公開的選擇性公開簽名來對能力進行簽名。 以下部分將介紹此簽名生成過程。

1. 用於能力分享的選擇性披露簽名生成：我們建議使用'可簡化簽名'作為選擇性披露簽名。類似的簽名生成過程也可以用於身份憑證創建，該過程用於圖4中的第2步。為了簡潔起見，在本文中，我們將展示使用可簡化簽名進行能力創建的過程。

圖6描述了可刪減簽名生成的樹狀結構。該樹狀結構是兩棵樹的組合，即GGM（Goldreich-Goldwasser-Micali）樹（標記為E，位於樹的左側）和Merkle哈希樹（標記為H，位於樹的右側）。生成樹狀結構有三個階段：（階段1 - 擴展）、（階段2 - 哈希）和（階段3 - 簽名）。在階段1中，從隨機種子Sϵ開始，通過GGM [32]從樹的頂部向下生成每個節點的隨機值。然後在階段2中，使用Merkle樹哈希從葉節點開始，從下向上生成Merkle樹。在我們的實現中，每個葉節點對應於特定的能力屬性，表示為Capt。每個Capt與階段1的隨機值一起進行哈希運算。左（L）和右（R）子節點的哈希值被連接並進行哈希運算以生成中間節點的值。哈希運算從葉節點一直向上到生成哈希根節點Rϵ。然後在階段3中，使用任何通用的簽名方法Sign0對根節點Rϵ進行簽名，產生σ = Sign0(Rϵ)。最後，生成能力Cap的可刪減簽名Sign(Cap)為（Sϵ，σ），並附帶來自GGM樹生成的隨機種子。為了簡潔起見，我們在一棵樹中顯示了所有階段，但在（階段1 - 擴展）和（階段2 - 哈希）中，在進行（階段3 - 簽名）之前，需要獨立地遍歷整個樹。

![Untitled](A%20Blockchain-Based%20Interoperable%20Architecture%20forI%20a99a8e32ea024d2fa5aab1538c8c5b1a/Untitled%203.png)

3）能力創建和驗證的算法：本節給出描述能力的詳細構造的算法定義。 構建過程包括DID生成、能力創建、聲明創建和能力驗證。 我們將所提出的算法定義為（Setup、GenerateDID、CreateCapability、CreateClaim、VerCapability）函數的組合。

![Untitled](A%20Blockchain-Based%20Interoperable%20Architecture%20forI%20a99a8e32ea024d2fa5aab1538c8c5b1a/Untitled%204.png)

![Untitled](A%20Blockchain-Based%20Interoperable%20Architecture%20forI%20a99a8e32ea024d2fa5aab1538c8c5b1a/Untitled%205.png)

D. Communications

![Untitled](A%20Blockchain-Based%20Interoperable%20Architecture%20forI%20a99a8e32ea024d2fa5aab1538c8c5b1a/Untitled%206.png)

在圖7中，我們說明了基於選擇性公開的能力屬性（即聲明claim）來滿足用戶訪問請求的通信協議。 該協議描述了三階段通信，如下所示。 第一階段（表示為DID連接）包括在能力用戶和能力發布者之間建立連接的初始過程。 第二階段（稱為選擇性披露）描述了能力和聲明生成過程。最後一個階段（表示為“訪問”）說明了對某些資源的訪問。 我們假設發行人已使用其 DID 在系統中註冊。

a)Stage 1: DID Connection: 

該階段從用戶生成 DID 並將新的 DID 註冊到區塊鏈層開始，以便用戶可以將自己標識為能力發行者。 (1a) 用戶需要使用 SD 合約調用函數GenerateDID( )（在第 IV-C3 節中描述）來生成 DID。 (1b) SD合約反過來將生成的DID和相應的DDO註冊到DID註冊表中。 然後，用戶 (2) 發送他的 DID、能力請求和發行者所需的信息（例如，Hung 醫生可以發送她的醫生註冊號）。 在接受請求後，（3）發行人驗證用戶的身份證明文件。 一旦用戶被完全識別，發行者將 (4) 生成特定於用戶和發行者之間通信的成對 DID 和密鑰對。

b)Stage 2: Selective Disclosure: 

發行者從其策略數據庫中獲取 (5) 相關策略，並根據存儲在賬本中的模板創建能力。 接下來，能力發布者（6a）從SD合約調用CreateCapability（）函數（在第IV-C3節中描述）來簽署生成的能力。 (6b) 合約又創建一個鏈上交易，將能力哈希存儲在能力註冊表中，以供將來驗證。 然後，發行人將該功能上傳到其安全雲存儲並為用戶生成鏈接，並且 (7) 將其發送到用戶的服務端點（從用戶 DID 中提取）。 用戶現在下載該功能並將其存儲在他的個人設備上。 需要時 (8)，用戶從 SD 合約中調用 CreateClaim 函數（在第 IV-C3 節中描述），以從功能中編輯所需的屬性。 (9) 編輯後的屬性與資源（即驗證者）共享以獲得訪問權限。

C) Stage 3 : Access Verification:

在接受訪問請求之前，(10a)資源從SD合約調用函數VerCapability()（在第IV-C3節中描述）以用於驗證目的。 (10b) SD合約驗證來自DID註冊表的用戶DID和發行者DID。 接下來，(10c)它驗證來自能力註冊表的共享聲明的真實性和完整性。 基於驗證結果，資源可以(11a)批准或(11b)拒絕用戶訪問請求。 這裡需要注意的是，訪問驗證對於每個訪問請求都是一次性的過程。 一旦請求被接受，資源就會將訪問權限與能力用戶 DID 一起存儲在其私有管理的資源表中，直到到期日期。 每次用戶聲明訪問權限時，資源只需將用戶 DID 與資源表進行匹配即可。

五、Implementation and evaluation

在本節中，我們將評估我們提出的體系結構。 我們通過實現我們架構的各個組件之間的互動來證明其可行性，如圖7所示。 我們衡量能力發佈過程的執行時間、輸送量、延遲和往返時間的效能。

A. Implementation

我們使用了所有在圖7中所示的交互來實現這個系統。這些交互是基於NodeJS來實現的。我們假設系統實體將使用他們的個人智能設備（例如智能手機）進行通信。要進行通信，每個設備需要與區塊鏈層進行交互，以提取通信實體的DID。相關的DDO包含了HTTP URL作為服務端點，以便進行通信。我們使用web3.js（Web3 JS API）來與區塊鏈層進行交互。智能合約實現了在鏈上的交易（例如DID註冊、能力註冊、選擇性披露合約），這些智能合約是使用NodeJS編寫的。我們選擇使用Hyperledger Fabric來實現區塊鏈層。為了評估目的，我們在DID註冊表中為能力發行者註冊了一個DID。稍後，這個發行者將會向能力使用者發放一個能力。

我們現在討論在第四節中描述的提案解決方案的概念驗證實現。在我們的實現架構中，如圖8所示，能力發行者（例如醫院A）通過由發行者託管的機構雲存儲將發行的能力提供給用戶（例如Dr Hung）。由於無法訪問實時機構雲存儲，我們使用Google Drive創建了演示環境。能力發行者將發行的能力上傳到他的Google Drive，並生成一個可共享的鏈接給能力使用者。我們的實現假設用戶在將能力分享給物聯網資源（例如ICU呼吸機）之前，先將能力下載並存儲在其個人智能設備中，通過從其設備生成的共享鏈接來進行分享。這些資源可能有自己內建的設置來解碼鏈接並將經過驗證的訪問權限存儲在其資源表中。

B. Results and Discussion

![所提出的系統實施示意圖，其中物聯網資源充當能力驗證者。每個資源都維護一個資源表，以存儲由能力使用者共享的經過區塊鏈驗證的能力屬性。](A%20Blockchain-Based%20Interoperable%20Architecture%20forI%20a99a8e32ea024d2fa5aab1538c8c5b1a/Untitled%207.png)

所提出的系統實施示意圖，其中物聯網資源充當能力驗證者。每個資源都維護一個資源表，以存儲由能力使用者共享的經過區塊鏈驗證的能力屬性。

我們在一台擁有8個核心和16GB RAM的Linux機器上部署了區塊鏈節點和註冊智能合約。
我們從同一台機器上生成客戶端請求，並使用Hyperledger Caliper來發送請求。在Caliper中有幾個可用的網絡模型，我們設置了一個模型，其中有三個背書節點用於三個通信實體（即能力發行者，用戶和驗證器）通過單一通信通道進行通信，還有一個排序節點用於運行訂單服務（即將收到的交易排序到區塊中）。

在接下來的測試中，我們對DID生成、能力創建、聲明創建和驗證進行了測試，因為它們涉及批准訪問權限的過程，因此假設在計算時間和整體系統性能方面有最大的貢獻。我們分析了實現架構（如圖8所示）的執行時間、吞吐量、延遲和整體性能。

![Untitled](A%20Blockchain-Based%20Interoperable%20Architecture%20forI%20a99a8e32ea024d2fa5aab1538c8c5b1a/Untitled%208.png)

**a)Execution Time Analysis:** 

為了了解提出的選擇性披露解決方案的開銷，我們分析了IV-C3中描述的函數的執行時間。圖9a顯示了我們分析的結果，每個數據點(data point)表示計算了20次運行的平均執行時間。我們將能力屬性的數量從4增加到256。結果顯示，執行時間與屬性大小成比例增加，但即使有256個屬性，驗證能力產生的最高開銷也低於55毫秒。

CreateCapability()的工作流程包括(i)生成用於對能力進行簽名的可縮減簽名的樹狀結構，以及(ii)將帶有簽名的能力的哈希作為交易發送到分佈式簿記。這個功能在32個屬性後呈現增長趨勢。接下來，CreateClaim()包括(i)刪除縮減的屬性，以及(ii)生成縮減的屬性的哈希。與其他兩個功能相比，該功能的執行時間較低。對於256個屬性，生成要求的時間不到38毫秒。下一個功能VerCapability()包括(i)重新生成用於驗證發行者簽名的可縮減簽名的樹狀結構，以及(ii)兩個讀操作，分別從能力發行者DID（即從DID登記）和從其工作流程中的能力登記檔檢索能力的哈希。與CreateCapability()相比，VerCapability()需要更長的時間來執行兩個讀操作。值得注意的是，雖然CreateCapability()將一個交易發送到分佈式簿記，但執行時間不包括將該交易提交到分佈式簿記中所需的時間。所有三個功能-CreateCapability()，CreateClaim()和VerCapability()隨著屬性數量加倍而呈線性增加，只有VerCapability()的4個屬性的執行時間例外。對於4個屬性的異常高值可能可以解釋為硬體對於驗證能力的非常少的資源而言過度的過剩。

**b)Throughput and Latency Analysis:** 

在Fig. 9b中，每個功能的延遲和吞吐量都被描述出來。我們對每個用戶發送10個交易（即10個用戶的100個交易，20個用戶的200個交易等）。在這裡，一個能力中的屬性數量被固定為四個屬性。延遲圖（顯示在左Y軸上的條形圖）顯示VerCapability()所花費的時間比AddDID()多，而AddDID()又比CreateCapability()和CreateClaim()多。CreateClaim()具有最小的延遲是很明顯的，因為它不從簿記中讀取或寫入，也不驗證任何簽名。相反，如前所述，CreateCapability()生成了一棵樹並向簿記發送了寫入請求。然而，CreateCapability()所花費的時間比VerCapability()少，因為CreateCapability()將能力寫入了簿記，這是一個僅包含四個屬性的JSON對象。由於這個JSON對象的大小很小，寫入請求的時間比VerCapability()所需的三個讀操作的時間少。如果我們增加能力中存儲的屬性數量，那麼CreateCapability()所花費的時間可能會超過VerCapability()。這一事實由AddDID()的行為證明。AddDID()所花費的時間比CreateCapability()多，因為它涉及將DDO寫入簿記，其中包含公鑰，服務端點，DID等。在AddDID()中寫入的屬性數量比CreateCapability()多，這導致了更大的延遲。然而，對於100個用戶（發送1000個交易），AddDID()的延遲少於6秒。對於所有四個功能，吞吐量都呈幾乎線性趨勢，只有在VerCapability()的情況下，用於非常少數用戶的延遲有例外。另一方面，在所有四個功能的情況下，延遲在前50個用戶時增加率較低，而從50個屬性開始，延遲增加率較高。這可能是因為交易挂起，因為交易生成率非常高。為了減少延遲，可以增加發行者和資源的數量。

對於吞吐量（顯示在右Y軸上的折線圖），所有功能在用戶數較少時顯示出幾乎相似的吞吐量。隨著用戶數量的增加，CreateCapability()和CreateClaim()的吞吐量變得比其他兩個更大，從而支持了延遲方面的觀察趨勢。值得注意的是，一旦我們改變了Fabric網絡中的用戶數量，吞吐量也可能不同。增加Fabric網絡中的用戶數量意味著增加了批准交易所需的時間。因此，這將導致延遲增加，進而導致吞吐量下降。

**c)Performance of Capability Issuance:** 

提出的解決方案進一步進行了整體性能測試。所有工作流程的單次往返時間包括將能力/索賠(claim)上傳到Google Drive，共享Google Drive的鏈接，從Google Drive下載能力/索賠，能力/索賠創建，將能力存儲在區塊鏈上，驗證索賠並將驗證響應發送給用戶。所有這些步驟所需的往返時間為24.27秒，其中大部分時間用於上傳、鏈接共享、下載和發送響應。能力/索賠的創建、存儲在區塊鏈上和索賠驗證只需4.5秒，相對於總共花費的時間來說相對較少。

六、conclusion and future work

在這篇論文中，我們提出了一種基於區塊鏈的、適用於大規模動態系統（例如物聯網）的帶有選擇性披露的訪問控制架構。與現有的工作不同，我們在論文中展示了在身份和訪問權限共享時選擇性披露信息的互操作性問題。我們提出的選擇性披露方案使用可簽署簽名來創建用於聲明對多個資源的訪問權限的能力，同時保護隱私。此外，我們的提案通過僅將能力的哈希值和相關的簽名存儲在區塊鏈上來提高了鏈上存儲的效率。我們通過在Hyperledger區塊鏈中實施了一個概念驗證原型來檢驗我們提出的方案的可行性和效率。我們的實驗結果顯示了該系統的實用性，並對核心組件的性能進行了詳細的性能分析，包括執行時間、吞吐量、延遲和整體性能的往返時間。在未來，我們計劃研究在將訪問權限從一個實體轉移到另一個實體時的訪問權限委派問題。我們還計劃在更大規模的場景中實施該系統，以測試其可行性和性能。